<!doctype html>
<html>
  <head>
    <title>Simple ThreeJS Overlay View</title>

    <link rel="stylesheet" type="text/css" href="./style.css" />
    <script type="module" src="./index.ts"></script>
  </head>
  <body>
    
    <div id="auth-controls" style="position: fixed; bottom: 0; left: 0; width: 100%; padding: 10px; background: rgba(0, 0, 0, 0.7); color: white; z-index: 2000; display: flex; justify-content: space-between; align-items: center; font-family: 'Press Start 2P', monospace; font-size: 8px;">
        <span id="user-status">Status: Loading...</span>
        <div>
            <button id="login-btn" class="gameboy-button" style="display: none; margin-right: 10px; background-color: #000000; color: #ffffff; border-color: #ffffff;">LOGIN</button>
            <button id="logout-btn" class="gameboy-button" style="display: none; background-color: #000000; color: #ffffff; border-color: #ffffff;">LOGOUT</button>
        </div>
    </div>
    
    <div id="welcome-message">
        <h1 style="margin: 0;">WELCOME TO DRAURA</h1>
    </div>
    
    <div id="control-message" style="display: none;">
        <h2 style="margin: 0; font-size: 14px;">CONTROLS</h2>
        <p style="margin: 10px 0 0; font-size: 10px; line-height: 1.6;">
            USE ARROW KEYS OR WASD TO DRIVE
        </p>
    </div>
    
    <div id="map" class="map"></div>
    
    <div id="question-overlay" class="gameboy-screen">
      <div id="question-popup" class="gameboy-dialog">
        <h2 id="question-title">QUESTION TIME!</h2>
        <p id="question-text">This is where the question will appear.</p>
        <div id="answer-buttons" class="btn-grid">
        </div>
        <p id="feedback-text"></p>
      </div>
    </div>

    <div id="alert-overlay" class="gameboy-screen" style="display: none;">
      <div id="alert-popup" class="gameboy-dialog">
        <h2 id="alert-title">ALERT!</h2>
        <p id="alert-text">This is an alert message.</p>
        <button id="alert-ok-btn" class="gameboy-button">OK</button>
      </div>
    </div>

    <div id="confirm-overlay" class="gameboy-screen" style="display: none;">
      <div id="confirm-popup" class="gameboy-dialog">
        <h2 id="confirm-title">CONFIRM</h2>
        <p id="confirm-text">Are you sure?</p>
        <div class="btn-grid" style="grid-template-columns: repeat(2, 1fr); max-width: 200px; margin: 20px auto;">
          <button id="confirm-yes-btn" class="gameboy-button">YES</button>
          <button id="confirm-no-btn" class="gameboy-button">NO</button>
        </div>
      </div>
    </div>
    
    <script type="module">
      const apiKey = import.meta.env.VITE_GOOGLE_MAPS_API_KEY;
      const callbackName = 'initMap'; // Your entry point function

      if (apiKey) {
        // Construct the script URL dynamically
        const script = document.createElement('script');
        script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&callback=${callbackName}&v=weekly`;
        
        // Add recommended attributes for best practice loading
        script.async = true; 
        script.defer = true;
        
        document.head.appendChild(script);
      } else {
        console.error("VITE_GOOGLE_MAPS_API_KEY is missing. Please check your .env file.");
      }
    </script>
    
  </body>
</html>